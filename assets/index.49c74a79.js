import{d as H,q as W,c as e,M as p,i as c,S as C,t as m,a as T,F as b,b as L,e as D,s as P,I as q,h as j,N as F,g as O,f as Q,j as U,k as V,u as A,l as S,A as z}from"./index.0938af14.js";const G=m("<div><div></div></div>"),R=m('<div class="flex gap-4"><div class="grid grid-cols-2 gap-y-2 gap-x-8"><div><span class="uppercase font-semibold">Abilities</span><div class="flex gap-2"></div></div><div><span class="uppercase font-semibold">Aspects</span><div class="flex gap-2"></div></div><div><span class="uppercase font-semibold">Fragments</span><div class="flex gap-2 col-span-2"></div></div></div></div>'),J=m('<div><span class="text-lg">Subclass</span></div>'),K=m('<div><span class="text-lg">Weapons</span><div class="flex gap-4"></div></div>'),X=m('<div><span class="text-lg">Armor</span><div class="flex flex-col gap-4"></div></div>'),Y=m('<div><span class="text-lg">Additional Mods</span><div class="flex gap-2 flex-wrap w-[calc(100vw-20rem)]"></div></div>'),Z=m('<div class="text-left"><div class="flex gap-4 items-center"><div class="text-2xl mb-3"></div><button class="bg-blue-300 text-blue-900 py-1 px-2 rounded h-min">Copy DIM Query</button></div><div class="flex flex-col gap-8"></div></div>'),ee=m('<div class="flex gap-4"></div>'),te=m('<div class="flex gap-4"><div class="grid grid-rows-2 gap-2"></div><div class="flex gap-2"></div></div>'),re=m("<p>Error: </p>"),ne=m("<p>Loading...</p>");function _(t){const n=()=>{let r=" ";return t.state?t.state===-1?" border-[3px] border-red-700":(t.state&q.Masterwork?r+="border-[3px] border-yellow-400":t.state&q.Crafted&&(r+="border-[3px] border-orange-400"),r):r};return(()=>{const r=G.cloneNode(!0),i=r.firstChild;return r.style.setProperty("background-size","100%"),L(u=>{const f=t.class+" bg-no-repeat bg-center",s=t.def?.displayProperties.name??"N/A",a=t.def?.displayProperties.icon!==void 0?`url(https://www.bungie.net${t.def?.displayProperties.icon})`:"",d="w-full h-full "+n();return f!==u._v$&&D(r,u._v$=f),s!==u._v$2&&P(r,"title",u._v$2=s),a!==u._v$3&&r.style.setProperty("background-image",u._v$3=a),d!==u._v$4&&D(i,u._v$4=d),u},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),r})()}function se(t){const n=()=>{const r=Object.values(t.subClass.key.socketOverrides??{}).map(a=>{const d=t.invDef.get(a);return{socket:a,def:d}});let i=[],u=[],f,s=[];for(const a of r)a.def.itemTypeDisplayName.includes("Aspect")?i.push(a):a.def.itemTypeDisplayName.includes("Fragment")?u.push(a):a.def.itemTypeDisplayName.includes("Super")?f=a:s.push(a);return{aspects:i,fragments:u,sup:f,other:s}};return(()=>{const r=R.cloneNode(!0),i=r.firstChild,u=i.firstChild,f=u.firstChild,s=f.nextSibling,a=u.nextSibling,d=a.firstChild,v=d.nextSibling,$=a.nextSibling,l=$.firstChild,g=l.nextSibling;return c(r,e(_,{class:"w-40 h-40",get def(){return t.subClass.def}}),i),c(r,e(_,{class:"w-20 h-20 -ml-8 -mt-4",get def(){return n().sup?.def}}),i),c(s,e(b,{get each(){return n().other},children:o=>e(_,{class:"w-12 h-12",get def(){return o.def}})})),c(v,e(b,{get each(){return n().aspects},children:o=>e(_,{class:"w-12 h-12",get def(){return o.def}})})),c(g,e(b,{get each(){return n().fragments},children:o=>e(_,{class:"w-12 h-12",get def(){return o.def}})})),r})()}function le(t){const n=()=>{const s=t.loadout.loadout.equipped.map(l=>{const g=t.items.find(h=>h.itemInstanceId===l.id),o=t.invDef.get(l.hash);return{key:l,invItem:g,def:o}}),a=s.find(l=>l.def.itemType===16),d=s.filter(l=>l.def.itemType===3),v=s.filter(l=>l.def.itemType===2),$=[v.find(l=>l.def.inventory?.bucketTypeHash===3448274439),v.find(l=>l.def.inventory?.bucketTypeHash===3551918588),v.find(l=>l.def.inventory?.bucketTypeHash===14239492),v.find(l=>l.def.inventory?.bucketTypeHash===20886954),v.find(l=>l.def.inventory?.bucketTypeHash===1585787867)];return{subClass:a,weapons:d,armor:$}},r=()=>(t.loadout.loadout.parameters.mods?.map(a=>{const d=t.invDef.get(a);return{key:a,def:d}})??[]).filter(a=>a.def),i=()=>n().armor.map((a,d)=>{const v=d===0?3448274439:d===1?3551918588:d===2?14239492:d===3?20886954:1585787867,l=(t.loadout.loadout.parameters.modsByBucket?.[v]??[]).map(h=>{const y=t.invDef.get(h);return{key:h,def:y}}),g=l.find(h=>h.def.itemType===19&&h.def.itemSubType===21||h.def.itemType===2),o=l.find(h=>h.def.itemType===19&&h.def.itemSubType===20);return{item:a,ornament:g,shader:o}}),u=()=>{const s=i().map((g,o)=>{g.item;const h=o===0?"helmet":o===1?"arms":o===2?"chest":o===3?"leg":o===4?"class":"unknown";return r().filter(x=>x.def?.itemTypeDisplayName.toLowerCase().includes(h))}),a=s.flat(),d=r().filter(g=>!a.some(o=>o.key===g.key)),v=i().map((g,o)=>s[o].reduce((x,w)=>x+(w.def.plug?.energyCost?.energyCost??0),0));for(const g of d)for(const o in v){const y=v[o]+(g.def.plug?.energyCost?.energyCost??0);if(!(y>10||s[o].some(w=>w.def.itemTypeDisplayName===g.def.itemTypeDisplayName))){g.def.itemTypeDisplayName.startsWith("General")?s[o].unshift(g):s[o].push(g),v[o]=y;break}}const $=s.flat(),l=r().filter(g=>!$.some(o=>o.key===g.key));return{bucketed:s,unfit:l}},f=()=>{const s=n().weapons.map(d=>d.invItem.itemInstanceId),a=n().armor.map(d=>d?.invItem.itemInstanceId).filter(d=>d);return[...s,...a].map(d=>`id:${d}`).join(" or ")};return(()=>{const s=Z.cloneNode(!0),a=s.firstChild,d=a.firstChild,v=d.nextSibling,$=a.nextSibling;return c(d,()=>t.loadout.loadout.name),v.$$click=()=>navigator.clipboard.writeText(f()),c($,e(T,{get when(){return n().subClass},get children(){const l=J.cloneNode(!0);return l.firstChild,c(l,e(se,{get subClass(){return n().subClass},get items(){return t.items},get invDef(){return t.invDef}}),null),l}}),null),c($,e(T,{get when(){return n().weapons.length>0},get children(){const l=K.cloneNode(!0),g=l.firstChild,o=g.nextSibling;return c(o,e(b,{get each(){return n().weapons},children:h=>(()=>{const y=ee.cloneNode(!0);return c(y,e(_,{class:"w-20 h-20",get def(){return h.def},get state(){return h.invItem?.state??-1}})),y})()})),l}}),null),c($,e(T,{get when(){return i().length>0},get children(){const l=X.cloneNode(!0),g=l.firstChild,o=g.nextSibling;return c(o,e(b,{get each(){return i()},children:(h,y)=>{const x=h.item,w=u().bucketed[y()];return(()=>{const k=te.cloneNode(!0),N=k.firstChild,M=N.nextSibling;return c(k,e(_,{class:"w-20 h-20",get def(){return x?.def},get state(){return x?.invItem?.state??-1}}),N),c(N,e(_,{class:"w-9 h-9",get def(){return h.ornament?.def}}),null),c(N,e(_,{class:"w-9 h-9",get def(){return h.shader?.def}}),null),c(M,e(b,{each:w,children:E=>e(_,{class:"w-20 h-20",get def(){return E.def}})})),k})()}})),l}}),null),c($,e(T,{get when(){return u().unfit.length>0},get children(){const l=Y.cloneNode(!0),g=l.firstChild,o=g.nextSibling;return c(o,e(b,{get each(){return u().unfit},children:h=>e(_,{class:"w-20 h-20",get def(){return h.def}})})),l}}),null),s})()}function ae(t){const n=W();return e(C,{get children(){return[e(p,{get when(){return n.data},get children(){return e(le,{get loadout(){return t.loadout},get items(){return t.items},get invDef(){return n.data}})}}),e(p,{get when(){return n.error},get children(){const r=re.cloneNode(!0);return r.firstChild,c(r,()=>n.error.message,null),r}}),e(p,{get when(){return n.isLoading},get children(){return ne.cloneNode(!0)}})]}})}H(["click"]);const ie=m('<div class="text-lg italic mt-2">No loadouts found. Upload a DIM Backup using the button above.</div>'),de=m('<div class="text-lg italic mt-2">No loadout selected.</div>'),oe=m("<div></div>"),ce=m('<div class="relative w-64"><img><div class="absolute top-0 left-0 right-0 pl-14 pr-4 text-white text-left"><div class="text-2xl flex"><div class="flex-1"></div><div class="text-[#f5dc56]"></div></div></div></div>'),ue=m('<div class="text-left"><div class="flex gap-4 items-center"></div><div class="flex flex-col px-2"></div></div>'),I=m("<p>Loading...</p>"),B=m("<p>Error: </p>"),fe=m('<div class="grid grid-cols-[16rem_1fr] gap-4 h-[calc(100vh-34px)]"><div class="overflow-auto"></div></div>'),ge=m('<main class="text-gray-700"></main>');function he(t){switch(t){case 0:return"Titan";case 1:return"Hunter";case 2:return"Warlock";default:return"Unknown"}}function me(t){const[n]=A(),r=()=>S().find(i=>i.loadout.id===n.id);return(()=>{const i=oe.cloneNode(!0);return c(i,e(C,{get fallback(){return e(ae,{get loadout(){return r()},get items(){return t.items}})},get children(){return[e(p,{get when(){return S().length===0},get children(){return ie.cloneNode(!0)}}),e(p,{get when(){return!r()},get children(){return de.cloneNode(!0)}})]}})),i})()}function ve(t){return(()=>{const n=ce.cloneNode(!0),r=n.firstChild,i=r.nextSibling,u=i.firstChild,f=u.firstChild,s=f.nextSibling;return c(f,()=>he(t.character.classType)),c(s,()=>t.character?.light),L(()=>P(r,"src",`https://www.bungie.net${t.character.emblemBackgroundPath}`)),n})()}function pe(t){const[n]=A();return(()=>{const r=ue.cloneNode(!0),i=r.firstChild,u=i.nextSibling;return c(i,e(ve,{get character(){return t.character}})),c(u,e(b,{get each(){return t.loadouts},children:f=>{const s=()=>f.loadout.id===n.id;return e(z,{get class(){return s()?"font-bold":""},get href(){return`?id=${f.loadout.id}`},get children(){return f.loadout.name}})}})),r})()}function $e(t){const n=V(t.profile,Object.keys(t.data.characters.data));return e(C,{get children(){return[e(p,{get when(){return n.every(r=>r.data)},get children(){return e(_e,{get data1(){return t.data},get data2(){return n.map(r=>r.data)}})}}),e(p,{get when(){return n.some(r=>r.isLoading)},get children(){return I.cloneNode(!0)}})]}})}function ye(t){const n=U(t.profile);return e(C,{get children(){return[e(p,{get when(){return n.data},get children(){return e($e,{get profile(){return t.profile},get data(){return n.data}})}}),e(p,{get when(){return n.error},get children(){const r=B.cloneNode(!0);return r.firstChild,c(r,()=>n.error.message,null),r}}),e(p,{get when(){return n.isLoading},get children(){return I.cloneNode(!0)}})]}})}function _e(t){const n=()=>{const i=t.data1.characters.data,u=S().reduce((s,a)=>{const d=a.loadout.classType;return s[d]||(s[d]=[]),s[d].push(a),s},{});let f=[];for(const s of Object.values(i)){if(f.some(d=>d.character.classType===s.classType))continue;const a=u[s.classType]??[];f.push({character:s,loadouts:a})}return f},r=()=>{const i=t.data1.profileInventory.data.items,u=t.data2.flatMap(s=>s.equipment.data.items),f=t.data2.flatMap(s=>s.inventory.data.items);return[...i,...u,...f]};return(()=>{const i=fe.cloneNode(!0),u=i.firstChild;return c(u,e(b,{get each(){return n()},children:f=>e(pe,{get character(){return f.character},get loadouts(){return f.loadouts},get items(){return r()}})})),c(i,e(me,{get items(){return r()}}),null),i})()}function xe(){if(!j())return e(F,{href:"/pre-lf-loadouts/login"});const t=O(),n=Q(t?.bungieMembershipId);return(()=>{const r=ge.cloneNode(!0);return c(r,e(C,{get children(){return[e(p,{get when(){return n.data},get children(){return e(ye,{get profile(){return{id:n.data?.profiles[0].membershipId,type:n.data?.profiles[0].membershipType}}})}}),e(p,{get when(){return n.error},get children(){const i=B.cloneNode(!0);return i.firstChild,c(i,()=>n.error.message,null),i}}),e(p,{get when(){return n.isLoading},get children(){return I.cloneNode(!0)}})]}})),r})()}export{xe as default};
